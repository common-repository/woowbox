window.wp=window.wp||{},window.WoowBox=window.WoowBox||{l10n:{}},window.WoowBox.data=window.WoowBox.data||{},window.WoowBox.Hook={hooks:{},register:function(e,t,i,s){for(var n=e.split(" "),o,a=0;a<n.length;a++)o=n[a],this.exists(o)||(this.hooks[o]={}),this.hooks[o][t]={callback:i,context:s}},call:function(e,t,i){if(void 0!==this.hooks[e])for(var s in this.hooks[e])if(this.hooks[e].hasOwnProperty(s)){var n=this.hooks[e][s];if(i||(i=n.context),!1===n.callback.apply(i,t))break}},exists:function(e){return void 0!==this.hooks[e]},remove:function(e,t){this.exists(e)&&delete this.hooks[e][t]}},jQuery(function($){var e=".woowbox-tabs-nav",t=window.location.hash,i=t.replace("!","").split("/")[0];if($(e).on("click",".nav-tab, a",function(t){t.preventDefault();var i=$(this).closest(e),s=$(i).data("container"),n=void 0!==$(this).attr("href")?$(this).attr("href"):$(this).data("tab");$(this).hasClass("woowbox-active")||($(i).find(".woowbox-active").removeClass("woowbox-active"),$(s).find("div.woowbox-active").removeClass("woowbox-active"),$(this).addClass("woowbox-active"),$(s).find(n).addClass("woowbox-active"),window.location.hash=n.split("#").join("#!"))}),t&&t.indexOf("woowbox-tab-")>=0){var s=$(i).parent(),n=$(s).data("navigation");$(n).find(".woowbox-active").removeClass("woowbox-active"),$(s).find("div.woowbox-active").removeClass("woowbox-active"),$(n).find('a[href="'+i+'"]').addClass("woowbox-active"),$(i).addClass("woowbox-active")}}),function($){Vue.use(Toasted);var e=window.WoowBox,t=$("#activity"),i,s={};i={props:["skin","preset","schema","id","disabled","options"],data:function(){return{}},computed:{value:{get:function(){var e=null;if(this.skin&&this.preset)return void 0!==this.$root.model&&this.id&&(e=this.$root.model[this.id]),null===e&&(e=this.schema.default),this.formatValueToField(e)},set:function(e){this.skin&&this.preset&&(e=this.formatValueToModel(e),this.id&&(this.$root.model[this.id]=e))}}},methods:{getFieldName:function(){var e=this.options&&this.options.fieldNameTemplate?this.options.fieldNameTemplate:"{name}",t;return this.schema.attr&&this.schema.attr.name&&(t=this.schema.attr.name),t=t||this.schema.name||this.id,t=e.replace("{name}",t)},getFieldType:function(e){var t;return this.schema.attr&&this.schema.attr.type&&(t=this.schema.attr.type),t=t||this.schema.type||"text",e&&"color"===t?"text":t},getFieldID:function(){var e=this.options&&this.options.fieldIdPrefix?this.options.fieldIdPrefix:"",t;return this.schema.attr&&this.schema.attr.id&&(t=this.schema.attr.id),t=t||this.schema.id||this.id,e+t},getFieldClasses:function(){var e=["field-"+this.id];return this.schema.attr&&this.schema.attr.class&&(_.isArray(this.schema.attr.class)?_.union(e,this.schema.attr.class):e.push(this.schema.attr.class)),e},getFieldAttributes:function(){var e={},t=this.getFieldType();if(t&&"text"!==t&&(e["data-type"]=t),this.schema.attr&&(e=$.extend(e,this.schema.attr)),this.schema.props)for(var i=0,s=this.schema.props.length,n;i<s;i++)n=this.schema.props[i],e[n]=!0;return e["data-preset"]=this.preset,e},formatValueToField:function(e){return e},formatValueToModel:function(e){return e}}},s["field-input"]=Vue.component("field-input",{mixins:[i],template:'<div class="wrapper">\n    <input class="form-control"\n           :class="getFieldClasses()"\n           :id="getFieldID()"\n           :type="getFieldType(true)"\n           :name="getFieldName()"\n           v-model="value"\n           v-bind="getFieldAttributes()"\n    >\n    <span class="helper" v-if="getFieldType() === \'color\' || getFieldType() === \'range\'">{{ value }}</span>\n</div>\n',data:function(){return{picker:null}},watch:{disabled:function(e){"color"===this.getFieldType()&&$.fn.spectrum&&(e?this.picker.spectrum("disable"):this.picker.spectrum("enable"))},value:function(e){"color"===this.getFieldType()&&$.fn.spectrum&&this.picker&&this.picker.spectrum("set",e)}},mounted:function(){this.$nextTick(function(){"color"===this.getFieldType()&&($.fn.spectrum?this.spectrumInit():console.warn("Spectrum color library is missing."))})},beforeDestroy:function(){this.picker&&this.picker.spectrum("destroy")},methods:{spectrumInit:function(){var e=this;this.picker=$('input[data-type="color"]',this.$el).spectrum("destroy").spectrum(_.defaults(this.schema.options||{},{color:this.value,showInput:!0,showAlpha:!0,disabled:this.disabled,allowEmpty:!1,preferredFormat:"hex",change:function(t){e.value=t?t.toString():null},move:function(t){e.value=t?t.toString():null}}))},formatValueToModel:function(e){if(null!==e){switch(this.getFieldType()){case"number":return Number(e);case"range":return Number(e)}}return e}}}),s["field-checkbox"]=Vue.component("field-checkbox",{mixins:[i],template:'<div class="wrapper">\n    <input type="checkbox"\n           v-model="value"\n           :class="getFieldClasses()"\n           :id="getFieldID()"\n           :name="getFieldName()"\n           v-bind="getFieldAttributes()"\n    >\n</div>',methods:{formatValueToField:function(e){return!!e},formatValueToModel:function(e){return null!==e?Number(e):e}}}),s["field-select"]=Vue.component("field-select",{mixins:[i],template:'<div class="wrapper">\n    <select class="form-control"\n           v-model="value"\n           :class="getFieldClasses()"\n           :id="getFieldID()"\n           :name="getFieldName()"\n           v-bind="getFieldAttributes()"\n    >\n         <option v-for="item in items" :value="getItemValue(item)" :disabled="isItemDisabled(item)">{{ getItemName(item) }}</option>\n    </select>\n</div>',data:function(){return{items:this.schema.options}},methods:{getItemValue:function(e){if(_.isObject(e)){if(void 0!==e.value)return e.value;throw"`value` is not defined"}return e},getItemName:function(e){if(_.isObject(e)){if(void 0!==e.name)return e.name;throw"`name` is not defined"}return e},isItemDisabled:function(e){return!!_.isObject(e)&&(void 0!==e.premium&&(e.premium&&!o.premium))}}});var n,o=new Vue({el:"#woowbox",components:s,data:{options:{fieldNameTemplate:"_woow_skin[{name}]"},premium:!1,skin:"",default_skin:"",preset:"default",presets:["default"],skin_info:"",model:{},defaults:{},schema:{},activeTab:"",new_preset:!1,new_preset_name:"",activity:!1},computed:{isSettingsDefault:function(){return JSON.stringify(this.model)===JSON.stringify(this.defaults)},isSettingsChanged:function(){var e=this.activity;return JSON.stringify(this.model)!==JSON.stringify($.extend({},this.defaults,window.woow_skin[this.skin].model[this.preset]))}},watch:{skin:function(e){function t(e,i){return i=i||{},$.each(e,function(e,s){"object"==typeof s&&(void 0!==s.default?i[e]=s.default:t(s,i))}),i}this.schema=$.extend({},window.woow_skin[e].schema),this.skin_info=$.extend({},window.woow_skin[e].info),this.activeTab=_.keys(this.schema)[0],this.defaults=t(this.schema),this.updatePresets(e),-1===this.presets.indexOf(this.preset)&&(this.preset="default"),this.model=$.extend({},this.defaults,window.woow_skin[e].model[this.preset]),this.fakeActivity(400)},preset:function(e){this.model=$.extend({},this.defaults,window.woow_skin[this.skin].model[e]),this.fakeActivity(400)},new_preset_name:function(e){this.new_preset_name=e.replace(/[&\/\\#,+()\[\]~%.'":;?<>{}^=|`]/g,"")}},mounted:function(){this.premium=!!$("#woowbox-license").val(),this.default_skin=$("#woowbox-default-skin").val();var e=this.default_skin.split(": ");this.skin=e[0],e[1]?this.preset=e[1]:this.preset="default"},methods:{fakeActivity:function(e){this.activity=!0,n&&clearTimeout(n),n=setTimeout(function(){o.activity=!1,n=null},e)},switchTab:function(e){this.activeTab=e},getFieldRowClasses:function(e){var t={disabled:this.fieldDisabled(e),readonly:this.fieldReadonly(e),required:this.fieldRequired(e),"premium-field":this.fieldPremium(e)};return _.isArray(e.styleClasses)?_.each(e.styleClasses,function(e){t[e]=!0}):_.isString(e.styleClasses)&&(t[e.styleClasses]=!0),t["field-"+e.tag]=!0,t},fieldTypeHasLabel:function(e){var t=e.type||e.tag;switch(e.attr&&e.attr.type&&(t=e.attr.type),t){case"button":case"submit":case"reset":return!1;default:return!0}},fieldDisabled:function(e){return!(!e.prop||!e.prop.disabled)&&e.prop.disabled},fieldRequired:function(e){return!(!e.prop||!e.prop.required)&&e.prop.required},fieldPremium:function(e){return!!e.premium},fieldVisible:function(e){if(!e.visible)return!0;var t,i;try{t=compileExpression(e.visible),i=t(this.model)}catch(e){i=!0}return i},fieldReadonly:function(e){return!(!e.prop||!e.prop.readonly)&&e.prop.readonly},fieldHint:function(e){return e.hint},getFieldTagType:function(e){return"field-"+e.tag},updatePresets:function(e){this.presets=Object.keys(window.woow_skin[e].model),this.new_preset=!1,this.new_preset_name=""},saveSkinSettings:function(){this.activity=!0;var t=this.skin,i=this.new_preset?this.new_preset_name:this.preset,s=this.model,n=this.defaults,a={action:"woow_save_skin_data",_nonce_woow_skin_settings_save:$("#_nonce_woow_skin_settings_save").val(),skin:t,preset:i,data:JSON.stringify(s)};if("default"===i&&this.isSettingsDefault&&(a.default_reset=!0),!i)return this.$toasted.error(e.l10n.fill_preset_name,{duration:2e3}),this.activity=!1,void $("#woowskin_preset").focus();$.post(ajaxurl,a,function(e){e&&e.success?(window.woow_skin[t].model[i]=$.extend({},n,s),o.updatePresets(t),o.skin=t,o.preset=i,o.$toasted.success(e.data,{duration:2e3}),o.updateSkinsListSetting()):e&&e.data?o.$toasted.error(e.data,{duration:2e3}):o.$toasted.error(":(",{duration:2e3})},"json").always(function(){o.activity=!1})},deletePreset:function(){this.activity=!0;var t=this.skin,i=this.preset,s={action:"woow_delete_skin_preset",_nonce_woow_skin_settings_save:$("#_nonce_woow_skin_settings_save").val(),skin:t,preset:i};if(this.default_skin.split(": ")[1]===i||"default"===i)return this.$toasted.error(e.l10n.delete_default_preset_error,{duration:2e3}),void(this.activity=!1);$.post(ajaxurl,s,function(e){e&&e.success?(delete window.woow_skin[t].model[i],o.updatePresets(t),o.skin=t,o.preset="default",o.$toasted.success(e.data,{duration:2e3}),o.updateSkinsListSetting()):e&&e.data?o.$toasted.error(e.data,{duration:2e3}):o.$toasted.error(":(",{duration:2e3})},"json").always(function(){o.activity=!1})},resetSkinSettingsChanges:function(){this.model=$.extend({},this.defaults,window.woow_skin[this.skin].model)},resetSkinSettings:function(){this.model=$.extend({},this.defaults)},updateSkinsListSetting:function(){var t="";$.each(window.woow_skin,function(e,i){t+='<option value="'+e+'">'+i.info.name+"</option>",$.each(i.model,function(s,n){"default"!==s&&(t+='<option value="'+e+": "+s+'">'+i.info.name+": "+s+"</option>")})});var i=$("select#woowbox-default-skin");i.length&&(i.find('option[value=""]').nextAll().remove(),i.append(t),i.val(this.default_skin));var s,n,o,a;if(window.parent!==window&&"function"==typeof window.parent.jQuery&&(s=window.parent.jQuery("select#woowbox-skin"),s.length)){o=s.attr("data-default_skin"),a=s.find('option[value="'+o+'"]').text(),n=s.val(),s.find('option[value="none"]').nextAll().remove(),s.append(t),s.find('option[value="'+o+'"]').text(a),s.val(n);var r=window.parent.jQuery("#tmpl-woowbox-gallery-settings"),l=$(r.html()),d=l.find("select#woowbox-skin");return d.find('option[value="none"]').nextAll().remove(),d.append(t),d.find('option[value="'+o+'"]').text(a),void r.html(l)}if(window.parent!==window&&"object"==typeof window.parent.elementor){var u={};e.l10n.default_skin&&(u.default=e.l10n.txt_default),$.each(window.woow_skin,function(e,t){u[e]=t.info.name,$.each(t.model,function(i,s){"default"!==i&&(u[e+": "+i]=t.info.name+": "+i)})}),e.l10n.default_skin&&(u[e.l10n.default_skin]+=e.l10n.txt_default_skin_sign),window.parent.ElementorConfig.widgets["woowbox-gallery"].controls.skin.options=u,s=window.parent.jQuery(".elementor-control-skin select"),s.length&&(n=s.val(),s.find("option").remove().append(t),s.append(t),e.l10n.default_skin&&s.find('option[value="'+e.l10n.default_skin+'"]').append(e.l10n.txt_default_skin_sign),s.val(n)),window.parent.jQuery(".elementor-control-change_skin_settings_trigger").find("input").val(+new Date).trigger("input")}}}});e.Skin=o,$(function(){function t(t,i){("check"!==i||t)&&(s.parent().addClass("activity"),$.post("https://woowgallery.com/woowbox/license-server.php",{action:i,site:e.l10n.siteurl,key:t},function(e){var t="";if(e&&e.success)t=e.key,e.success.message&&Vue.toasted.success(e.success.message,{duration:2e3});else if(e&&e.error)Vue.toasted.error(e.error.message,{duration:2e3});else if(Vue.toasted.error(":(",{duration:2e3}),"check"===i)return;("activate"!==i||t)&&("check"===i&&t||$.post(ajaxurl,{action:"woowbox_license",_nonce_woowbox_settings_save:$("#_nonce_woowbox_settings_save").val(),license:t,license_action:i},function(e){e&&e.success?(e.data&&Vue.toasted.success(e.data,{duration:2e3}),setTimeout(function(){window.location.href=window.location.href},1600)):e&&e.data?e.data&&Vue.toasted.error(e.data,{duration:2e3}):t&&Vue.toasted.error(":@",{duration:2e3})},"json"))},"json").always(function(){s.parent().removeClass("activity")}))}var i=$("#woowbox-license"),s=$(".woowbox-license-action-button"),n=$("#woowbox-license-plugin");s.on("click",function(e){e.preventDefault();var s=i.val(),n=$(this).attr("data-action");s&&n&&t(s,n)}),"WoowBox"===n.val()&&t(i.val(),"check")})}(jQuery);
//# sourceMappingURL=./settings.min.js.map